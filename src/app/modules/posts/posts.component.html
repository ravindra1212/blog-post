<div class="flex">
    <div class="flex-column-first">
        <div class="page-header">
            Posts
            <button pButton type="button" label="Add Post" icon="pi pi-plus" class="mx-1 p-button-sm float-end"
                (click)="openAddNewPostDialog()"></button>
        </div>
        <div>
            <p-table [value]="posts" styleClass="p-datatable-gridlines">
                <ng-template pTemplate="header">
                    <tr>
                        <th *ngFor="let col of cols">
                            {{col.header}}
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-post>
                    <tr>
                        <td *ngFor="let col of cols">

                            <ng-container *ngIf="col.field == 'action'">
                                <button pButton type="button" label="Edit" icon="pi pi-pencil" 
                                    class="mx-1 p-button-sm" (click)="openEditPostDialog(post)"></button>
                                <button pButton type="button" label="Delete" icon="pi pi-trash" 
                                    class="mx-1 p-button-sm p-button-danger" (click)="deletePost($event, post._id)"></button>
                            </ng-container>

                            <ng-container else>
                                {{post[col.field]}}
                            </ng-container>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage" let-columns>
                    <tr>
                        <td [attr.colspan]="3" class="text-center">
                            No records found
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</div>

<!-- ADD OR EDIT POST FORM -->
<p-dialog [header]="formTitle" [(visible)]="display" [modal]="true" [style]="{width: '50vw'}"
    [draggable]="false" [resizable]="false" position="top">
    
    <form [formGroup]="postForm" (ngSubmit)="saveOrUpdate(postForm.get('_id').value)">

        <!-- Title Input Field -->
        <div class="form-group">
            <label for="title">Title</label>
            <input type="text" class="form-control" formControlName="title" />
            <app-form-errors [formObject]="postForm" controlName="title"></app-form-errors>
        </div>
        <!-- /Title Input Field -->

        <!-- Description Input Field -->
        <div class="form-group mt-4">
            <label for="body">Description</label>
            <textarea rows="5" class="form-control" cols="30" id="body" formControlName="body"></textarea>
            <app-form-errors [formObject]="postForm" controlName="body"></app-form-errors>
        </div>
        <!-- /Description Input Field -->

        <!-- Form Action -->
        <div class="form-group mt-4">
            <button pButton pRipple type="button" (click)="closeDialog()" label="Cancel" class="float-start p-button-raised p-button-secondary"></button>
            <button pButton pRipple type="submit" [label]="formBtnLabel" [disabled]="postForm.invalid" [loading]="inProgressForm" class="float-end p-button-raised"></button>
        </div>
        <!-- /Form Action -->

    </form>

</p-dialog>
<!-- /ADD OR EDIT POST FORM -->


